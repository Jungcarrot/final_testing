<script>
    // Firebase 초기화 설정
    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
        databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_PROJECT_ID.appspot.com",
        messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
        appId: "YOUR_APP_ID"
    };

    // Firebase 초기화
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // 회원가입 유효성 검사 및 데이터 저장
    function validateSignup(event) {
        event.preventDefault();
        const username = document.getElementById('signup-username').value;
        const nickname = document.getElementById('signup-nickname').value;
        const password = document.getElementById('signup-password').value;
        const confirmPassword = document.getElementById('signup-confirm-password').value;

        if (username.trim() === "" || nickname.trim() === "" || password.trim() === "" || confirmPassword.trim() === "") {
            alert('모든 필드를 입력해 주세요.');
            return false;
        }

        if (password !== confirmPassword) {
            document.getElementById('password-check-message').style.display = 'block';
            return false;
        } else {
            document.getElementById('password-check-message').style.display = 'none';
        }

        // Firebase에 사용자 정보 저장
        const userData = {
            uid: Date.now(),  // 간단한 UID 생성 방식. 실제 환경에서는 고유 UID 생성 필요
            nickName: nickname,
            loginID: username,
            password: password,
            apiId: 1,  // 임시 값, 실제 환경에 따라 변경 가능
            login_method: 1  // 임시 값, 실제 환경에 따라 변경 가능
        };

        // UserData 경로에 저장
        database.ref('UserData/' + userData.uid).set(userData)
            .then(() => {
                alert('회원가입이 완료되었습니다. 로그인 페이지로 이동합니다.');
                window.location.href = 'login.html';
            })
            .catch((error) => {
                console.error("회원가입 중 오류 발생:", error);
            });

        return false;
    }

    // 아이디 중복 검사
    function checkUsernameDuplicate() {
        const username = document.getElementById('signup-username').value;
        if (username.trim() === "") {
            alert('아이디를 입력해 주세요.');
            return;
        }

        database.ref('UserData').orderByChild('loginID').equalTo(username).once('value')
            .then((snapshot) => {
                if (snapshot.exists()) {
                    alert('이미 사용 중인 아이디입니다.');
                    document.getElementById('signup-username').setCustomValidity('이미 사용 중인 아이디입니다.');
                    document.getElementById('signup-username').reportValidity();
                } else {
                    alert('사용 가능한 아이디입니다.');
                    document.getElementById('signup-username').setCustomValidity('');
                    document.getElementById('signup-username').reportValidity();
                }
            })
            .catch((error) => {
                console.error("아이디 중복 검사 중 오류 발생:", error);
            });
    }

    // 닉네임 중복 검사
    function checkNicknameDuplicate() {
        const nickname = document.getElementById('signup-nickname').value;
        if (nickname.trim() === "") {
            alert('닉네임을 입력해 주세요.');
            return;
        }

        database.ref('UserData').orderByChild('nickName').equalTo(nickname).once('value')
            .then((snapshot) => {
                if (snapshot.exists()) {
                    alert('이미 사용 중인 닉네임입니다.');
                } else {
                    alert('사용 가능한 닉네임입니다.');
                }
            })
            .catch((error) => {
                console.error("닉네임 중복 검사 중 오류 발생:", error);
            });
    }
</script>

